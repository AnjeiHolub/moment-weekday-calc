/*! moment-weekday-calc 1.0.4 andruhon <andrew@kondratev.pro> 2015-08-19 */
"undefined"!=typeof require&&(moment=require("moment")),function(a){function b(b,d,e,g,h){if(this.rangeStart=a(b),this.rangeEnd=a(d),this.exclusions=g,this.useIsoWeekday=1==h,this.rangeStart.isAfter(this.rangeEnd))throw new c("rangeStart is after rangeEnd");this.weekdays=f(e,this.useIsoWeekday)}function c(a){this.message=a,this.name="WeekDayCalcException"}function d(b,c,d,e){this.rangeStart=a(b),this.useIsoWeekday=1==e,this.exclusions=d,this.weekdays=f(c,this.useIsoWeekday)}function e(a){this.message=a,this.name="DaysSetConverterException"}b.prototype.calculate=function(){var a=0,b=this.rangeStart.clone().endOf("week"),c=this.rangeEnd.clone().startOf("week");if(c.diff(b,"days")<30||this.exclusions)a=this.calculateIterative(this.rangeStart,this.rangeEnd,this.weekdays,this.exclusions);else{var d=Math.round(c.diff(b,"weeks",!0));a+=d*this.weekdays.length,a+=this.calculateIterative(this.rangeStart,b,this.weekdays),a+=this.calculateIterative(c,this.rangeEnd,this.weekdays)}return a},b.prototype.calculateIterative=function(a,b,c,d){for(var e=0,f=a.clone(),h=g(d);f.valueOf()<=b.valueOf();){var i=this.useIsoWeekday?"isoWeekday":"weekday";c.indexOf(f[i]())>=0&&(0==h.length||h.indexOf(f.format("YYYY-MM-DD"))<0)&&e++,f.add(1,"day")}return e},Function.prototype.construct=function(a){var b=this,c=function(){b.apply(this,a)};return c.prototype=b.prototype,new c},c.prototype=new Error,b.prototype.WeekDayCalcException=c,d.prototype.calculate=function(a){for(var b=a,c=this.rangeStart.clone(),d=g(this.exclusions),e=this.useIsoWeekday?"isoWeekday":"weekday";b>0;)c.add(1,"day"),this.weekdays.indexOf(c[e]())>=0&&(0==d.length||d.indexOf(c.format("YYYY-MM-DD"))<0)&&b--;return c},e.prototype=new Error,d.prototype.DaysSetConverterException=e;var f=function(b,d){var e=[];if(!b)throw new c("weekdays must be defined");if(b.length>7)throw new c("Weekdays array exceeding week length of 7 days");for(var f=0;f<b.length;f++){var g=b[f];if(d){if(isNaN(g))throw new c("isoWeekDayCalc accepts weekdays as numbers only, try using weekdayCalc if you need a locale aware behaviour");if(1>g||g>7)throw new c("The weekday is out of 1 to 7 range")}else if(isNaN(g))g=a().day(g).weekday();else if(0>g||g>6)throw new c("The weekday is out of 0 to 6 range");if(e.indexOf(g)>=0)throw new c("Weekdays set contains duplicate weekday");e.push(g)}return e},g=function(b){var c=[];if(b)for(;b.length>0;)c.push(a(b.shift()).format("YYYY-MM-DD"));return c};b.calculateWeekdays=function(d,e,f){var g,h,i,j;switch(f=f?!0:!1,e.length){case 4:j=e[3];case 3:g=a(e[0]).startOf("day"),h=a(e[1]).endOf("day"),i=e[2];break;case 2:g=d,h=e[0],i=e[1];break;case 1:var k=e[0];k&&k.rangeEnd&&k.weekdays?(g=k.rangeStart?a(k.rangeStart).startOf("day"):d,h=a(k.rangeEnd).endOf("day"),i=k.weekdays,j=k.exclusions):(g=d.clone().startOf("year"),h=d.clone().endOf("year"),i=k);break;default:new c("unexpected arguments length "+e.length+". Expecting 1 to 4 args")}if(g.isAfter(h)){var l=g.clone();g=h.clone(),h=l}var m=b.construct([g,h,i,j,f]);return m.calculate()},d.calculateDate=function(a,b,c){var f,g,h;c=c?!0:!1;switch(b.length){case 3:g=b[2];case 2:f=b[0],h=b[1];break;case 1:var i=b[0];if(!i||void 0==i.days&&void 0==i.workdays)f=i;else{if(void 0!=i.days&&void 0!=i.workdays)throw new e("days and weekdays args should not be used together, because weekdays is an alias of days");f=i.days?i.days:i.workdays,h=i.weekdays?i.weekdays:[1,2,3,4,5],g=i.exclusions}break;default:new e("unexpected arguments length "+b.length+". Expecting 1 to 3 args")}var j=d.construct([a,h,g,c]);return j.calculate(f)},a.fn.weekdayCalc=function(){return b.calculateWeekdays(this,arguments)},a.fn.isoWeekdayCalc=function(){return b.calculateWeekdays(this,arguments,!0)},a.fn.addWorkdays=function(a,b){return d.calculateDate(this,[a,[1,2,3,4,5],b])},a.fn.workdaysToCalendarDays=function(a,b){var c=d.calculateDate(this,[a,[1,2,3,4,5],b]);return c.diff(this,"days")},a.fn.addWeekdaysFromSet=function(){return d.calculateDate(this,arguments)},a.fn.weekdaysFromSetToCalendarDays=function(){var a=d.calculateDate(this,arguments);return a.diff(this,"days")},a.fn.isoAddWeekdaysFromSet=function(){return d.calculateDate(this,arguments,!0)},a.fn.isoWeekdaysFromSetToCalendarDays=function(){var a=d.calculateDate(this,arguments,!0);return a.diff(this,"days")},"object"==typeof exports&&"undefined"!=typeof module?module.exports=b:"function"==typeof define&&define.amd?define(b):this.WeekDayCalc=b}(moment);
//# sourceMappingURL=moment-weekday-calc.min.js.map